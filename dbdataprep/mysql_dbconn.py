# coding=utf-8
import pymysql
# import kafka
class QdasSql(object):
    # Mysqldb ???connect ???????????
    def __init__(self, host='localhost', port=3306, dbName='testdb', user='root', password='time4@FUN'):
        self.db = pymysql.connect(host=host, port=port,user=user, passwd=password, db=dbName, charset='utf8mb4')
        # ??????????????????????????
        self.cursor = self.db.cursor()


    # ??????close() ?????????
    def __del__(self):
        self.db.close()
    # ????????????????????????
    def execute(self,sql):
        self.cursor.execute(sql)


    # ????????
    def fetchall(self):
        return self.cursor.fetchall()

    # ????????
    def fetchmany(self,size):
        return self.cursor.fetchmany(size)

    # ??????????
    def fetchone(self):
        return self.cursor.fetchone()

    # ??????commit????????eg?????????
    def execute_commit(self,sql):
        try:
            # ??sql??
            self.cursor.execute(sql)
            # ????????
            self.db.commit()
        except:
            # ???????
            self.db.rollback()

    def commit(self):
        self.db.commit()
